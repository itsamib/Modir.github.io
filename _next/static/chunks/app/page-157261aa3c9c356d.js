(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6335:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>O});var l=i(5155),t=i(2115),n=i(1090),a=i(7911),r=i(6695),c=i(285),o=i(6874),d=i.n(o),x=i(2543),m=i(9968),h=i(8763),u=i(7223),p=i(8186),g=i(286),j=i(8718),f=i(2144),v=i(7481),b=i(4165),N=i(2523),y=i(5057);function C(e){let{isOpen:s,onClose:i,onSave:n,buildingName:a}=e,[r,o]=(0,t.useState)(a),[d,x]=(0,t.useState)(""),{t:m}=(0,f.o)();return(0,t.useEffect)(()=>{s&&(o(a),x(""))},[s,a]),(0,l.jsx)(b.lG,{open:s,onOpenChange:i,children:(0,l.jsxs)(b.Cf,{className:"sm:max-w-[425px]",children:[(0,l.jsxs)(b.c7,{children:[(0,l.jsx)(b.L3,{className:"font-headline",children:m("editBuildingDialog.title")}),(0,l.jsx)(b.rr,{children:m("editBuildingDialog.description")})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(y.J,{htmlFor:"name",className:"text-right",children:m("createBuildingDialog.nameLabel")}),(0,l.jsx)(N.p,{id:"name",value:r,onChange:e=>o(e.target.value),className:"col-span-3",placeholder:m("createBuildingDialog.namePlaceholder")})]}),d&&(0,l.jsx)("p",{className:"text-sm font-medium text-destructive col-span-4 text-center",children:d})]}),(0,l.jsxs)(b.Es,{children:[(0,l.jsx)(c.$,{variant:"outline",onClick:i,children:m("global.cancel")}),(0,l.jsx)(c.$,{type:"submit",onClick:()=>{if(!r.trim())return void x(m("createBuildingDialog.errorNameRequired"));x(""),n(r)},children:m("global.save")})]})]})})}var k=i(10);function w(e){let{buildings:s}=e,{t:i,language:a}=(0,f.o)(),{exportData:o,updateBuilding:b,deleteBuilding:N}=(0,n.C)(),{toast:y}=(0,v.dj)(),w="fa"===a?x.A:m.A,[D,B]=(0,t.useState)(!1),[S,L]=(0,t.useState)(!1),[R,A]=(0,t.useState)(null),O=e=>{let s=new Blob([o(e.id)],{type:"application/json"}),l=URL.createObjectURL(s),t=document.createElement("a");t.href=l,t.download="".concat(e.name,"-backup.json"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(l),y({title:i("home.exportSuccessTitle"),description:i("home.exportSuccessDesc"),className:"bg-primary text-primary-foreground"})},$=e=>{A(e),B(!0)},E=e=>{A(e),L(!0)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,l.jsxs)(r.Zp,{className:"flex flex-col hover:shadow-lg transition-shadow duration-300",children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)(r.ZB,{className:"font-headline text-2xl text-primary",children:e.name}),(0,l.jsx)(r.BT,{children:i("buildingList.cardDescription")})]}),(0,l.jsxs)("div",{className:"flex rtl:flex-row-reverse ltr:flex-row gap-1",children:[(0,l.jsx)(c.$,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>$(e),children:(0,l.jsx)(h.A,{size:16})}),(0,l.jsx)(c.$,{variant:"ghost",size:"icon",className:"w-8 h-8 text-destructive hover:text-destructive",onClick:()=>E(e),children:(0,l.jsx)(u.A,{size:16})})]})]})}),(0,l.jsx)(r.Wu,{className:"flex-grow",children:(0,l.jsxs)("div",{className:"flex items-center text-muted-foreground space-x-4 space-x-reverse",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(p.A,{size:16}),(0,l.jsxs)("span",{children:[e.units.length," ",i("buildingList.units")]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(g.A,{size:16}),(0,l.jsxs)("span",{children:[e.expenses.length," ",i("buildingList.expenses")]})]})]})}),(0,l.jsxs)(r.wL,{className:"flex flex-col sm:flex-row gap-2",children:[(0,l.jsx)(c.$,{asChild:!0,className:"w-full",children:(0,l.jsxs)(d(),{href:"/building/".concat(e.id),className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:i("buildingList.viewDashboard")}),(0,l.jsx)(w,{size:16})]})}),(0,l.jsxs)(c.$,{variant:"outline",onClick:()=>O(e),className:"w-full flex items-center gap-2",children:[(0,l.jsx)(j.A,{size:16}),(0,l.jsx)("span",{children:i("buildingList.exportJson")})]})]})]},e.id))}),R&&(0,l.jsx)(C,{isOpen:D,onClose:()=>B(!1),onSave:e=>{R&&(b(R.id,e),B(!1),A(null),y({title:i("editBuildingDialog.successTitle"),description:i("editBuildingDialog.successDesc",{oldName:R.name,newName:e}),className:"bg-primary text-primary-foreground"}))},buildingName:R.name}),(0,l.jsx)(k.Lt,{open:S,onOpenChange:L,children:(0,l.jsxs)(k.EO,{children:[(0,l.jsxs)(k.wd,{children:[(0,l.jsx)(k.r7,{children:i("deleteBuildingDialog.title")}),(0,l.jsx)(k.$v,{children:i("deleteBuildingDialog.description",{buildingName:null==R?void 0:R.name})})]}),(0,l.jsxs)(k.ck,{children:[(0,l.jsx)(k.Zr,{onClick:()=>A(null),children:i("global.cancel")}),(0,l.jsx)(k.Rx,{onClick:()=>{R&&(N(R.id),L(!1),A(null))},className:"bg-destructive hover:bg-destructive/90",children:i("global.delete")})]})]})})]})}function D(e){let{isOpen:s,onClose:i,onSave:n}=e,[a,r]=(0,t.useState)(""),[o,d]=(0,t.useState)(1),[x,m]=(0,t.useState)(""),{t:h}=(0,f.o)(),u=()=>{r(""),d(1),m(""),i()};return(0,l.jsx)(b.lG,{open:s,onOpenChange:u,children:(0,l.jsxs)(b.Cf,{className:"sm:max-w-[425px]",children:[(0,l.jsxs)(b.c7,{children:[(0,l.jsx)(b.L3,{className:"font-headline",children:h("createBuildingDialog.title")}),(0,l.jsx)(b.rr,{children:h("createBuildingDialog.description")})]}),(0,l.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(y.J,{htmlFor:"name",className:"text-right",children:h("createBuildingDialog.nameLabel")}),(0,l.jsx)(N.p,{id:"name",value:a,onChange:e=>r(e.target.value),className:"col-span-3",placeholder:h("createBuildingDialog.namePlaceholder")})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,l.jsx)(y.J,{htmlFor:"unitCount",className:"text-right",children:h("createBuildingDialog.unitsLabel")}),(0,l.jsx)(N.p,{id:"unitCount",type:"number",value:o,onChange:e=>d(Math.max(1,parseInt(e.target.value)||1)),className:"col-span-3"})]}),x&&(0,l.jsx)("p",{className:"text-sm font-medium text-destructive col-span-4 text-center",children:x})]}),(0,l.jsxs)(b.Es,{children:[(0,l.jsx)(c.$,{variant:"outline",onClick:u,children:h("global.cancel")}),(0,l.jsx)(c.$,{type:"submit",onClick:()=>a.trim()?o<=0?void m(h("createBuildingDialog.errorUnitsRequired")):void(m(""),n(a,o),r(""),d(1)):void m(h("createBuildingDialog.errorNameRequired")),children:h("global.save")})]})]})})}let B=(0,i(157).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var S=i(4301),L=i(9434),R=i(3173);function A(e){let{isFading:s}=e,{t:i}=(0,f.o)();return(0,l.jsx)("div",{className:(0,L.cn)("fixed inset-0 flex flex-col items-center justify-center bg-background z-50 transition-opacity duration-500",s?"opacity-0":"opacity-100"),children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-6 animate-fade-in-slow",children:[(0,l.jsx)(R.A,{className:"w-24 h-24 text-primary"}),(0,l.jsx)("h1",{className:"text-4xl font-bold font-headline text-primary tracking-tight",children:i("global.appName")})]})})}function O(){let{buildings:e,addBuilding:s,loading:i,importData:r,importExcelData:o}=(0,n.C)(),[d,x]=(0,t.useState)(!1),[m,h]=(0,t.useState)(!1),[u,p]=(0,t.useState)(null),g=(0,t.useRef)(null),{t:b}=(0,f.o)(),{toast:N}=(0,v.dj)(),[y,C]=(0,t.useState)(!1),[R,O]=(0,t.useState)(!0),[$,E]=(0,t.useState)(!1);return((0,t.useEffect)(()=>{C(!0);let e=setTimeout(()=>{E(!0),setTimeout(()=>O(!1),500)},2e3);return()=>clearTimeout(e)},[]),y)?R?(0,l.jsx)(A,{isFading:$}):(0,l.jsxs)("div",{className:(0,L.cn)("flex flex-col min-h-screen bg-background","animate-fade-in"),children:[(0,l.jsx)(a.Header,{}),(0,l.jsxs)("main",{className:"flex-grow container mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[(0,l.jsx)("h1",{className:"text-3xl font-headline font-bold text-primary",children:b("home.myBuildings")}),(0,l.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,l.jsx)("input",{type:"file",ref:g,className:"hidden",accept:"application/json, .xlsx, .xls",onChange:e=>{var s;let i=null==(s=e.target.files)?void 0:s[0];i&&(p(i),h(!0)),e.target.value=""}}),(0,l.jsxs)(c.$,{onClick:()=>{var e;null==(e=g.current)||e.click()},variant:"outline",className:"flex items-center gap-2",children:[(0,l.jsx)(B,{size:20}),(0,l.jsx)("span",{children:b("home.importData")})]}),(0,l.jsxs)(c.$,{onClick:()=>{try{let e=exportData(),s=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(s),l=document.createElement("a");l.href=i,l.download="backup-all-buildings.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i),N({title:b("home.exportSuccessTitle"),description:b("home.exportSuccessDesc"),className:"bg-primary text-primary-foreground"})}catch(e){console.error("Global export failed:",e),N({title:b("global.error"),description:b("reportsTab.exportErrorDesc"),variant:"destructive"})}},variant:"outline",className:"flex items-center gap-2",children:[(0,l.jsx)(j.A,{size:20}),(0,l.jsx)("span",{children:b("home.exportAll")})]}),(0,l.jsxs)(c.$,{onClick:()=>x(!0),className:"flex items-center gap-2",children:[(0,l.jsx)(S.A,{size:20}),(0,l.jsx)("span",{children:b("home.newBuilding")})]})]})]}),i?(0,l.jsx)("p",{children:b("home.loadingBuildings")}):e.length>0?(0,l.jsx)(w,{buildings:e}):(0,l.jsxs)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-muted-foreground",children:b("home.noBuildingsFound")}),(0,l.jsx)("p",{className:"text-muted-foreground mt-2",children:b("home.noBuildingsCTA")}),(0,l.jsx)(c.$,{onClick:()=>x(!0),className:"mt-4",children:b("home.newBuilding")})]})]}),(0,l.jsx)(D,{isOpen:d,onClose:()=>x(!1),onSave:(e,i)=>{s(e,i),x(!1)}}),(0,l.jsx)(k.Lt,{open:m,onOpenChange:h,children:(0,l.jsxs)(k.EO,{children:[(0,l.jsxs)(k.wd,{children:[(0,l.jsx)(k.r7,{children:b("home.importConfirmTitle")}),(0,l.jsx)(k.$v,{children:b("home.importConfirmDesc")})]}),(0,l.jsxs)(k.ck,{children:[(0,l.jsx)(k.Zr,{onClick:()=>p(null),children:b("global.cancel")}),(0,l.jsx)(k.Rx,{onClick:()=>{if(u)if(u.name.endsWith(".xlsx")||u.name.endsWith(".xls"))o(u,(e,s)=>{e?N({title:b("home.importSuccessTitle"),description:s,className:"bg-primary text-primary-foreground"}):N({title:b("global.error"),description:s,variant:"destructive"}),h(!1),p(null)});else{let e=new FileReader;e.onload=e=>{try{var s;let i=null==(s=e.target)?void 0:s.result;"string"==typeof i&&(r(i),N({title:b("home.importSuccessTitle"),description:b("home.importSuccessDesc"),className:"bg-primary text-primary-foreground"}))}catch(e){console.error("Import failed:",e),N({title:b("global.error"),description:b("home.importErrorDesc"),variant:"destructive"})}finally{h(!1),p(null)}},e.readAsText(u)}},className:"bg-destructive hover:bg-destructive/90",children:b("home.importConfirmAction")})]})]})})]}):null}},6583:(e,s,i)=>{Promise.resolve().then(i.bind(i,6335))}},e=>{var s=s=>e(e.s=s);e.O(0,[524,65,413,723,567,441,721,358],()=>s(6583)),_N_E=e.O()}]);